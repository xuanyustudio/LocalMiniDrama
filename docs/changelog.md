# 版本历史 / Changelog

**导航：[项目主页](../README.md) | [English](en.md)**

---

## v1.1.8（当前）

- 🆕 **NanoBanana 图片厂商**：新增 NanoBanana 作为独立图片生成厂商，支持 nano-banana-2 / nano-banana-pro / nano-banana 三个模型，兼容官方 API 与代理模式（如星衍云 staryanai.com）；自动推断 endpoint / query_endpoint，支持异步轮询与同步代理两种响应模式
- 🆕 **AI 配置导出 / 导入**：一键导出全部 AI 配置为 JSON 文件，换机或团队共享配置直接导入，导入为追加模式不覆盖已有配置
- 🆕 **端点字段可配置**：图片、分镜、视频类型配置均可手动填写「提交端点」和「查询端点」，方便对接各类代理或自定义服务；预设厂商留空由系统自动推断
- 🔧 **分镜参考图优化**：角色图和场景参考图优先读取本地文件并转为 Base64 传给图片 API，彻底解决外链过期或跨网络不可达导致生成失败的问题
- 🔧 **doubao-seedream 参数修正**：参考图字段名由 `imageUrls` 修正为官方规范 `image`，自动移除 `n` 参数并关闭水印（`watermark: false`），适配 Volcengine / 自定义代理

---

## v1.1.7

- 🆕 **UI 全面美化**：引入紫色主题，卡片阴影、渐变、圆角全面升级，视觉更现代；亮色模式改为**默认主题**
- 🆕 **提示词高级设置**：AI 配置页新增「高级设置（提示词）」Tab，支持自定义 9 个核心提示词（故事生成、分镜系统提示、故事扩展、分镜用户指令、角色提取、场景提取、道具提取、首帧/关键帧/尾帧图描述），修改后立即生效；JSON 输出格式部分加锁保护，不可编辑；随时一键恢复默认
- 🆕 **AI 厂商自定义选项**：厂商下拉菜单底部新增「自定义（直接输入厂商名）」选项，消除用户对输入框能否手填的疑问
- 🔧 **提示词持久化**：自定义提示词通过 SQLite 持久存储（`prompt_overrides` 表），后端内存缓存加速读取，重启不丢失

---

## v1.1.6

- 🆕 **工程导出/导入**：完整打包工程为 ZIP（含图片、视频、文字、配置），换机或分享一包搞定；导入时自动检测重名，冲突自动加后缀（如「导入1」）
- 🆕 **画面比例设置**：新建项目时选定比例（16:9 / 9:16 / 1:1 / 4:3 等），后续生成图片和视频全程自动适配
- 🆕 **视频参数扩展**：视频生成支持 `resolution`（分辨率）、`seed`（随机种子）、`camera_fixed`（固定摄像机）、`watermark`（水印）等参数
- 🆕 **视频合并进度展示**：合成完整剧集视频时，前端实时展示合并进度
- 🔧 **图片生成去水印**：火山引擎图片生成默认传入 `watermark: false`，去除生成图片水印
- 🔧 **视频 API 参数规范**：`ratio` 和 `duration` 改为独立字段传入 Volcengine API（不再嵌入 prompt 文本）
- 🔧 **Volcengine 模型名映射**：自动将展示名（如 `Doubao-Seedance-1.0-pro-fast`）映射为正确的 API 端点 ID
- 🔧 **图片尺寸自动适配**：所有生成服务（分镜图、场景图、角色图、道具图）均根据项目比例自动计算合适尺寸，满足 Volcengine 最低像素要求
- 🔧 **道具重提取更新**：再次从剧本提取道具时，已有道具的描述和提示词会更新，保留已生成的图片
- 🔧 **导出 ZIP 修复**：修复导出文件只有 9 字节的问题（Axios 拦截器对 blob 类型特殊处理）
- 🔧 **导入数据关联修复**：导入时正确创建 `episode_characters`（角色-集数关联），并为场景和道具设置 `episode_id`，修复导入后看不到角色/场景/道具的问题

---

## v1.1.4

- 🆕 **剧集管理页**：新增独立的剧集管理页面（`/drama/:id`），统一管理剧集信息、本剧资源库与分集列表
- 🆕 **资源库分层**：本剧资源库（按剧过滤）与全局素材库严格隔离，修复了不同剧集资源互相可见的 Bug
- 🆕 **素材库导入**：在剧集管理页可一键从全局素材库导入角色/场景/道具
- 🆕 **分集管理增强**：支持新增/删除分集，显示剧本前 20 字作为预览
- 🔧 **图片替换修复**：AI 生成图片后手动上传新图可正确替换旧图（修复 `local_path` 未清除问题）
- 🆕 **明暗主题切换**：支持暗色/白天模式，偏好持久保存，三个页面均可切换
- 🔧 **导航改进**：制作页新增「返回剧集」按钮；新建项目后直接进入制作页；分集列表点击可精确跳转对应集

---

## v1.1.x 历史改进

- 🆕 **一键生成流水线**：一键生成视频 + 补全并生成，自动跳过已有内容
- 🆕 **失败重试机制**：每步最多重试 3 次，应对 429 限流等错误，不中断流程
- 🆕 **实时进度展示**：流水线执行中实时显示步骤与错误日志
- 🆕 **视频提示词编辑**：手工编辑全文 + 组成字段展开编辑（景别/运镜独立配置）
- 🆕 **图片提示词编辑**：每个分镜可单独查看和修改图片提示词
- 🆕 **分镜视频错误展示**：生成失败的错误信息直接显示在分镜卡片上并持久化
- 🔧 **AI 配置优化**：支持多种服务商（DashScope / Volcengine 等）连接测试

---

## v1.0.x 初始版本

- 项目立项与基础架构搭建（Vue 3 + Node.js + Electron）
- 剧本生成、角色/场景/道具提取
- 分镜生成与图片/视频生成核心流程
- SQLite 数据持久化
- Windows exe 打包

---

[← 返回项目主页](../README.md)
